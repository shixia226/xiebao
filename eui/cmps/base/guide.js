EUI.defineCmp("guide",function(t,i){"use strict";function e(t){e._superClass.call(this,t);var s=this._property;s.cls_active=t.cls_active,s.item4clone=t.initClone.call(this,this.doc,t);var r=t.initItem;s.initItem=!!i.isFunction(r)&&r,s.name_itemlist=t.name_itemlist||"container";var n,a,l=t.items;if(l)for(n=0,a=l.length;n<a;n++)this.add(l[n]);var h=t.datas;if(h)for(n=0,a=h.length;n<a;n++)this.setData(h[n],null,n)}return e.getItem=function(t,i,e){if(-1!==(i=this.getIndex(i,null==e||e)))return this._property.items[i][t]},i.inherit(e,t,{add:function(t){t=t||{};var i=this._property,e=i.items,s=e.length,r=parseInt(t.index);if((isNaN(r)||r<0||r>s)&&(r=s),!1!==this.emit("onadding",r,t)){var n=i.item4clone.cloneNode(!0),a={visible:!0,itemDom:n},l=i.initItem;if(l&&l.call(this,a,t),e.splice(r,0,a),this.setData(t.data,null,r),r===s)i[i.name_itemlist].appendChild(n);else{var h=i.items[r+1];i[i.name_itemlist].insertBefore(n,h.itemDom)}var v=i.activeidx;return-1===v||!1!==t.resetactive?(v>=r&&(i.activeidx+=1),this.setActive(r)):v>=r&&(i.activeidx+=1,this.emit("onswitched",v+1,v,!1)),this.emit("onadded",r,t),r}},remove:function(t){if(-1===(t=this.getIndex.apply(this,arguments)))return!1;if(!1===this.emit("onremoving",t))return!1;var i=this._property,e=i.items,s=e.splice(t,1)[0],r=i.activeidx;if(i[i.name_itemlist].removeChild(s.itemDom),r===t){i.activeidx=-1;var n=e.length;this.setActive(n===r?r-1:r)}else r>t&&this.emit("onswitched",i.activeidx=r-1,r,!1);return this.emit("onremoved",t,s),s},getCount:function(){return this._property.items.length},getActive:function(){return this._property.activeidx},setActive:function(t){if(-1===(t=this.getIndex.apply(this,arguments)))return!1;var e=this._property,s=e.activeidx;if(s===t)return!1;if(!1===this.emit("onswitching",t,s))return!1;var r=e.items;-1!==s&&i.removeClass(r[s].itemDom,e.cls_active);var n=r[e.activeidx=t];i.addClass(n.itemDom,e.cls_active),n.visible||this.setItemVisible(t,!0),this.emit("onswitched",t,s,!0)},nextActive:function(){var t=this.getIndex.apply(this,arguments);if(-1===t)return!1;for(var i=this._property,e=i.items,s=t+1,r=e.length;s<r;s++)if(e[s].visible)return this.setActive(s),s;for(var s=0;s<t;s++)if(e[s].visible)return this.setActive(s),s;return-1===i.activeidx?(this.setActive(t),t):-1},prevActive:function(){var t=this.getIndex.apply(this,arguments);if(-1!==t){for(var i=this._property,e=i.items,s=t-1;s>=0;s--)if(e[s].visible)return this.setActive(s),s;for(var s=e.length-1;s>t;s--)if(e[s].visible)return this.setActive(s),s;return-1===i.activeidx?(this.setActive(t),t):-1}},getIndex:function(t){var e=this._property,s=parseInt(t);if(!isNaN(s)&&s>=0&&s<e.items.length)return s;var r,n;if(1===arguments.length?t&&(1===t.nodeType?(r="itemDom",n=t):(r=t.name,n=t.value)):i.isString(t)&&(r=i.startWith(t,"data_",!0),n=arguments[1]),!r)return e.activeidx;for(var a=e.items,l=0,h=a.length;l<h;l++)if(a[l][r]===n)return l;return-1},getItem:function(t){if(t){var i=this.getIndex.apply(this,[].slice.call(arguments,1));if(-1!==i){return this._property.items[i][t]}}},getData:function(t){var e=this.getIndex.apply(this,[].slice.call(arguments,1));if(-1!==e){var s=this._property.items[e];if(!i.isString(t)){var r={},n="data_".length;for(var a in s)i.startWith(a,"data_")&&(r[a.substr(n)]=s[a]);return r}return s[i.startWith(t,"data_",!0)]}},setData:function(t,e){if(t){var s=this.getIndex.apply(this,[].slice.call(arguments,2));if(-1!==s){var r=this._property.items[s];if(i.isString(t))null==e?delete r[i.startWith(t,"data_",!0)]:r[i.startWith(t,"data_",!0)]=e;else for(var n in t)r[i.startWith(""+n,"data_",!0)]=t[n]}}},setItemVisible:function(t){var i=this.getIndex.apply(this,[].slice.call(arguments,1));if(-1===i)return!1;var e=this._property,s=e.items[i];return s.visible!==(t=!1!==t)&&((s.visible=t)?(s.itemDom.style.display="",-1===e.activeidx&&this.setActive(i)):(s.itemDom.style.display="none",e.activeidx===i&&-1===this.nextActive()&&(e.activeidx=-1)),i)},isItemVisible:function(t){return e.getItem.call(this,"visible",t,arguments[1])}}),e});